fresh_rss:
  # Example: https://freshrss.example.com/api/greader.php
  greader_api_url: "https://freshrss.example.com/api/greader.php"
  username: "api-user"
  api_password: "replace-with-freshrss-api-password"
  verify_tls: true
  timeout_seconds: 20
  retry_attempts: 3
  retry_backoff_seconds: 2
  page_size: 100
  max_items: 300
  unread_only: true
  lookback_hours: 72

ai:
  enabled: true
  # For Ollama OpenAI mode include /v1.
  # Example: http://ollama.ai-stack.svc.cluster.local:11434/v1
  base_url: "http://ollama.ai-stack.svc.cluster.local:11434/v1"
  api_key: "dummy"
  model: "llama3.1:8b"
  temperature: 0.1
  max_tokens: 700
  timeout_seconds: 45
  retry_attempts: 2
  retry_backoff_seconds: 1.5

enrichment:
  enabled: true
  timeout_seconds: 12
  verify_tls: true
  max_chars: 7000
  min_summary_chars: 260
  user_agent: "FreshRSS-BI-Enricher/1.0"
  # Optional domain skip list for paywalled or noisy sources.
  skip_domains: []

taxonomy:
  event_types:
    - pricing_change
    - outage_incident
    - security_incident
    - layoffs_reorg
    - funding_mna
    - product_launch
    - cloud_cost_signal
    - regulatory_change
    - partner_change
    - customer_reference
    - other

scoring:
  # Scores are clamped to 0-100, and customer min_alert_score values are
  # also clamped into this range.
  min_alert_score: 45
  default_weights:
    keyword_match: 5.5
    competitor_match: 8.0
    cloud_match: 7.0
    feed_match: 30.0
    domain_match: 12.0
    context_match: 4.0
    urgency: 4.0
    health_risk: 20.0
    cloud_spend_pressure: 20.0
    churn_risk: 16.0
    renewal_risk: 16.0
    novelty: 10.0
    renewal_window_boost: 10.0
    renewal_window_days: 90

dynamic_thresholds:
  enabled: true
  percentile: 0.82
  blend_weight: 0.65
  min_history: 30
  clamp_min: 25
  clamp_max: 90
  history_size: 400

alert_routing:
  min_confidence_for_alert: 0.5
  watchlist_score_floor: 30
  cooldown_hours: 48
  no_signal_days: 7

feedback:
  enabled: false
  file: "./feedback/labels.jsonl"
  min_samples_for_adjustment: 5
  max_adjustment: 0.25

customers:
  - id: acme_health
    name: Acme Health
    url: "https://acmehealth.example.com"
    min_alert_score: 50
    feed_urls:
      - "https://acmehealth.example.com/press-releases/rss"
    keywords:
      - acme health
      - epic
      - cerner
      - healthcare
      - cms
      - hipaa
    competitors:
      - datadog
      - microsoft
      - google cloud
    cloud_keywords:
      - aws
      - azure
      - gcp
      - cloud pricing
      - egress
      - kubernetes
    tech_stack:
      - epic
      - cerner
      - aws
    strategic_themes:
      - patient data protection
      - cloud modernization
    known_risks:
      - ransomware
      - outage
    renewal_date: "2026-11-15"
    event_type_weights:
      security_incident: 12
      outage_incident: 10
      pricing_change: 9
      regulatory_change: 8

  - id: northwind_saas
    name: Northwind SaaS
    url: "https://northwindsaas.example.com"
    min_alert_score: 48
    feed_urls:
      - "https://northwindsaas.example.com/blog/rss"
      - "https://northwindsaas.example.com/news/rss"
    keywords:
      - northwind
      - saas spend
      - finops
      - platform engineering
      - renewal
    competitors:
      - snowflake
      - databricks
      - atlassian
    cloud_keywords:
      - commit discount
      - cloud bill
      - reserved instances
      - aws
      - azure
      - gcp
    context_terms:
      - platform engineering
      - data governance
      - cost optimization
    renewal_date: "2026-09-30"
    event_type_weights:
      cloud_cost_signal: 12
      pricing_change: 11
      layoffs_reorg: 7
      funding_mna: 6

state:
  file: "./state/bi_pipeline_state.json"
  keep_seen_ids: 15000
  story_state_max_items: 10000

output:
  directory: "./output"
  top_n_per_customer: 5
  # Optional output retention controls.
  # Set retention_days to 0 to disable age-based pruning.
  retention_days: 30
  # Set max_run_directories to 0 to disable count-based pruning.
  max_run_directories: 400
  webhook_url: ""
  webhook_timeout_seconds: 10

influxdb:
  enabled: false
  # Example in-cluster service URL:
  # http://influxdb.observability.svc.cluster.local:8086
  url: "http://influxdb.observability.svc.cluster.local:8086"
  org: "home"
  bucket: "homeassistant"
  token: ""
  timeout_seconds: 10
  measurement_prefix: "freshrss_bi"
