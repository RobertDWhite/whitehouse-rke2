apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: sdr-research

resources:
  # Core infrastructure
  - 00-namespace.yaml
  - 01-configmap.yaml
  - 02-pvc-artifacts.yaml

  # SDR capture pipeline
  - 03-rtl-sdr-daemonset.yaml
  - 03b-rtl-tcp-service.yaml
  - 04-unified-sdr-configmap.yaml
  - 05-unified-sdr-deployment.yaml
  - 08-cw-decoder-configmap.yaml
  - 09-cw-decoder-deployment.yaml
  - 10-aprs-decoder-configmap.yaml
  - 11-aprs-decoder-deployment.yaml
  - 10a-voice-decoder-configmap.yaml
  - 10b-voice-decoder-deployment.yaml
  - 11-pvc-whisper-cache.yaml

  # Web viewer
  - 20-pvc-cache.yaml
  - 21-postgres-statefulset.yaml
  # 22-secret.sops.yaml - handled by ksops generator
  - 30a-configmap-api-overrides.yaml
  - 30-deployment-api.yaml
  - 31-service-api.yaml
  - 32-deployment-ui.yaml
  - 33-service-ui.yaml
  - 40-ingress.yaml
  - 41-authentik-service.yaml

generators:
  - ksops.yaml

images:
  - name: librespace/gnuradio
    newTag: "3.10.5.1"
  - name: linuxserver/faster-whisper
    newTag: "3.1.0"
  - name: postgres
    newTag: "15"
  - name: registry.white.fm/sdr-viewer-api
    newTag: "1.7.2"
  - name: registry.white.fm/sdr-viewer-ui
    newTag: "1.5.2"
